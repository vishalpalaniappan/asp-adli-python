{
    "description": "Contains the design for library manager v2. The ID's refer to abstractions that can be observed from the execution of a system. This allows you to construct design level traces from execution that is distributed across nodes, threads and processes.",
    "behavior": [
        {
            "id": "SelectAcceptBookAndAddToBasket",
            "group": "MainMenuGroup",
            "abstractions": [
                "AcceptBookInformation",
                "AddBookToBasket"
            ]
        },
        {
            "id": "SelectPlaceBooksOnShelf",
            "group": "PlaceBooksOnShelfGroup",
            "abstractions": [
                "CheckIfTooManyBooks",
                "PlaceBookOnShelf"
            ]
        },
        {
            "id": "SelectFailIfTooManyBooks",
            "group": "FailIfTooManyBooksGroup",
            "abstractions": [
                "FailIfTooManyBooks"
            ]
        },
        {
            "id": "SelectDisplayLibrary",
            "group": "MainMenuGroup",
            "abstractions": [
                "DisplayBookShelf",
                "DisplayBasket"
            ]
        },
        {
            "id": "SelectPlaceBookOnShelf",
            "group": "PlaceBookOnShelfGroup",
            "abstractions": [
                "GettingBookFromBasket",
                "GettingFirstNameOfBook",
                "CheckingIfShelfHasSlot",
                "AddingBookToShelf",
                "ReturnBooks"
            ]
        },
        {
            "id": "SelectCreateSlotForBook",
            "group": "CreateSlotForBookGroup",
            "abstractions":[
                "CreateSlotForBookOnShelf"
            ]
        },
        {
            "id": "SelectTerminateProgram",
            "group": "MainMenuGroup",
            "abstractions":[
                "ExitTheMenu"
            ]
        }
    ],
    "modules": {
        "root": {
            "id": "root",
            "nodes": [
                {
                    "id": "CreateBasketAndBookShelf"
                },
                {
                    "id": "DisplayMenuAndAcceptResponse"                    
                },
                {
                    "type": "selector",
                    "description": "Select Menu Option",
                    "selectors": [
                        {
                            "id": "SelectAddBookToBasket",
                            "behavior": [
                                {
                                    "id": "AcceptBookInformation",
                                    "module_name": "AcceptBookModule",
                                    "type":"module"
                                },
                                {
                                    "id": "AddBookToBasket"
                                }
                            ]
                        },
                        {
                            "id": "SelectPlaceBookOnShelf",
                            "behavior":  [
                                {
                                    "type": "selector",
                                    "description": "Simulate failure by checking if basket is too heavy.",
                                    "selectors": [
                                        {
                                            "id": "SelectAddBookToBasket",
                                            "behavior": [
                                                {
                                                    "id": "FailIfTooManyBooks"
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "id": "PlaceBookOnShelf",
                                    "type":"module"
                                }
                            ]
                        },
                        {
                            "id": "SelectDisplayLibrary",
                            "behavior": [
                                {
                                    "id": "DisplayBookShelf"
                                },
                                {
                                    "id": "DisplayBasket"
                                }
                            ]
                        },
                        {
                            "id": "LeaveLibrary",
                            "type": "end"
                        }
                    ]
                },
                {
                    "type":"goto",
                    "module": "root",
                    "target_id": "DisplayMenuAndAcceptResponse"
                }
            ]
        },
        "AcceptBookModule" : {
            "id": "AcceptBookModule",
            "nodes": [
                {
                    "id": "DisplayRequest"
                },
                {
                    "id": "AcceptBookName"
                },
                {
                    "id": "AcceptBookGenre"
                },
                {
                    "id": "AssembleBookDetails"
                },
                {
                    "id": "ReturnBookDetails"
                }
            ]
        },
        "PlaceBookOnShelf" : {
            "id": "PlaceBookOnShelfModule",
            "nodes": [
                {
                    "type": "selector",
                    "description": "Check for books in basket",
                    "selectors": [
                        {
                            "id": "CheckingBasketForBook",
                            "behavior": [
                                {
                                    "id": "GettingBookFromBasket"
                                },
                                {
                                    "id": "GettingFirstNameOfBook"
                                },
                                {
                                    "type": "selector",
                                    "description": "Selects Behavior that Creates a Slot for the Book.",
                                    "selectors": [
                                        {
                                            "id": "CheckingIfShelfHasSlot",
                                            "behavior": [
                                                {
                                                    "id": "CreateSlotForBookOnShelf"
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "id": "AddingBookToShelf"
                                },
                                {
                                    "type":"goto",
                                    "module": "PlaceBookOnShelf",
                                    "target_id": "CheckingBasketForBook"
                                }
                            ]
                        },
                        {
                            "id": "ReturnBooks",
                            "type": "return"
                        }
                    ]
                }
            ]
        }
    }
}